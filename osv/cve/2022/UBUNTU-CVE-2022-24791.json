{
  "schema_version": "1.6.3",
  "id": "UBUNTU-CVE-2022-24791",
  "details": "Wasmtime is a standalone JIT-style runtime for WebAssembly, using Cranelift. There is a use after free vulnerability in Wasmtime when both running Wasm that uses externrefs and enabling epoch interruption in Wasmtime. If you are not explicitly enabling epoch interruption (it is disabled by default) then you are not affected. If you are explicitly disabling the Wasm reference types proposal (it is enabled by default) then you are also not affected. The use after free is caused by Cranelift failing to emit stack maps when there are safepoints inside cold blocks. Cold blocks occur when epoch interruption is enabled. Cold blocks are emitted at the end of compiled functions, and change the order blocks are emitted versus defined. This reordering accidentally caused Cranelift to skip emitting some stack maps because it expected to emit the stack maps in block definition order, rather than block emission order. When Wasmtime would eventually collect garbage, it would fail to find live references on the stack because of the missing stack maps, think that they were unreferenced garbage, and therefore reclaim them. Then after the collection ended, the Wasm code could use the reclaimed-too-early references, which is a use after free. Patches have been released in versions 0.34.2 and 0.35.2, which fix the vulnerability. All Wasmtime users are recommended to upgrade to these patched versions. If upgrading is not an option for you at this time, you can avoid the vulnerability by either: disabling the Wasm reference types proposal, config.wasm_reference_types(false); or by disabling epoch interruption if you were previously enabling it. config.epoch_interruption(false).",
  "aliases": [],
  "related": [
    "CVE-2022-24791"
  ],
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    },
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "published": "2022-03-31T23:15:00Z",
  "modified": "2025-06-13T12:26:04Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:18.04:LTS",
        "name": "mozjs52",
        "purl": "pkg:deb/ubuntu/mozjs52@52.9.1-0ubuntu0.18.04.1?arch=source&distro=esm-infra/bionic"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "52.3.1-0ubuntu3",
        "52.3.1-7fakesync1",
        "52.8.1-0ubuntu0.18.04.1",
        "52.9.1-0ubuntu0.18.04.1"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:18.04:LTS",
        "name": "mozjs38",
        "purl": "pkg:deb/ubuntu/mozjs38@38.8.0~repack1-0ubuntu4?arch=source&distro=esm-apps/bionic"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "38.8.0~repack1-0ubuntu1",
        "38.8.0~repack1-0ubuntu3",
        "38.8.0~repack1-0ubuntu4"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:20.04:LTS",
        "name": "mozjs68",
        "purl": "pkg:deb/ubuntu/mozjs68@68.6.0-1ubuntu1?arch=source&distro=esm-infra/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "68.5.0-1~fakesync",
        "68.5.0-2~fakesync",
        "68.6.0-1",
        "68.6.0-1ubuntu1"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:20.04:LTS",
        "name": "mozjs52",
        "purl": "pkg:deb/ubuntu/mozjs52@52.9.1-1ubuntu3?arch=source&distro=esm-apps/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "52.9.1-1build1",
        "52.9.1-1ubuntu3"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "firefox",
        "purl": "pkg:deb/ubuntu/firefox@1:1snap1-0ubuntu1?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1:1snap1-0ubuntu1"
            }
          ]
        }
      ],
      "versions": [
        "93.0+build1-0ubuntu3",
        "94.0+build3-0ubuntu1",
        "94.0.2+build1-0ubuntu1",
        "94.0.2+build2-0ubuntu1",
        "95.0+build1-0ubuntu1",
        "95.0.1+build2-0ubuntu1",
        "95.0.2+build1-0ubuntu1",
        "96.0+build2-0ubuntu1",
        "96.0.1+build1-0ubuntu1",
        "96.0.2+build1-0ubuntu1",
        "96.0.3+build1-0ubuntu1",
        "97.0+build1-0ubuntu1",
        "97.0+build2-0ubuntu1",
        "97.0.1+build1-0ubuntu1"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "firefox",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-af",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-an",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ar",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-as",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ast",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-az",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-be",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-bg",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-bn",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-br",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-bs",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ca",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-cak",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-cs",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-csb",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-cy",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-da",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-de",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-el",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-en",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-eo",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-es",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-et",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-eu",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-fa",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-fi",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-fr",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-fy",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ga",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-gd",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-gl",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-gn",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-gu",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-he",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-hi",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-hr",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-hsb",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-hu",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-hy",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ia",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-id",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-is",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-it",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ja",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ka",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-kab",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-kk",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-km",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-kn",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ko",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ku",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-lg",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-lt",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-lv",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-mai",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-mk",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ml",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-mn",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-mr",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ms",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-my",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-nb",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ne",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-nl",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-nn",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-nso",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-oc",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-or",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-pa",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-pl",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-pt",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ro",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ru",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-si",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-sk",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-sl",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-sq",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-sr",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-sv",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-sw",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-szl",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ta",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-te",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-th",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-tr",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-uk",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-ur",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-uz",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-vi",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-xh",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-zh-hans",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-zh-hant",
            "binary_version": "1:1snap1-0ubuntu1"
          },
          {
            "binary_name": "firefox-locale-zu",
            "binary_version": "1:1snap1-0ubuntu1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "mozjs78",
        "purl": "pkg:deb/ubuntu/mozjs78@78.15.0-4ubuntu1?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "78.13.0-1",
        "78.15.0-2",
        "78.15.0-4ubuntu1"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "mozjs91",
        "purl": "pkg:deb/ubuntu/mozjs91@91.10.0-0ubuntu1?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "91.5.1-0ubuntu1",
        "91.6.0-1",
        "91.6.0-2",
        "91.7.0-2",
        "91.10.0-0ubuntu1"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "thunderbird",
        "purl": "pkg:deb/ubuntu/thunderbird@1:115.18.0+build1-0ubuntu0.22.04.1?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "1:91.1.2+build1-0ubuntu1",
        "1:91.3.0+build2-0ubuntu1",
        "1:91.3.1+build1-0ubuntu1",
        "1:91.3.2+build1-0ubuntu1",
        "1:91.4.0+build1.1-0ubuntu1",
        "1:91.4.0+build2-0ubuntu1",
        "1:91.5.0+build1-0ubuntu1",
        "1:91.5.1+build1-0ubuntu1",
        "1:91.6.1+build1-0ubuntu1",
        "1:91.7.0+build1-0ubuntu1",
        "1:91.7.0+build2-0ubuntu1",
        "1:91.8.0+build2-0ubuntu1",
        "1:91.9.1+build1-0ubuntu0.22.04.1",
        "1:91.11.0+build2-0ubuntu0.22.04.1",
        "1:102.2.2+build1-0ubuntu0.22.04.1",
        "1:102.4.2+build2-0ubuntu0.22.04.1",
        "1:102.7.1+build2-0ubuntu0.22.04.1",
        "1:102.8.0+build2-0ubuntu0.22.04.1",
        "1:102.9.0+build1-0ubuntu0.22.04.1",
        "1:102.10.0+build2-0ubuntu0.22.04.1",
        "1:102.11.0+build1-0ubuntu0.22.04.1",
        "1:102.13.0+build1-0ubuntu0.22.04.1",
        "1:102.15.0+build1-0ubuntu0.22.04.1",
        "1:102.15.1+build1-0ubuntu0.22.04.1",
        "1:115.3.1+build1-0ubuntu0.22.04.2",
        "1:115.4.1+build1-0ubuntu0.22.04.1",
        "1:115.5.0+build1-0ubuntu0.22.04.1",
        "1:115.6.0+build2-0ubuntu0.22.04.1",
        "1:115.8.1+build1-0ubuntu0.22.04.1",
        "1:115.9.0+build1-0ubuntu0.22.04.1",
        "1:115.10.1+build1-0ubuntu0.22.04.1",
        "1:115.11.0+build2-0ubuntu0.22.04.1",
        "1:115.12.0+build3-0ubuntu0.22.04.1",
        "1:115.13.0+build5-0ubuntu0.22.04.1",
        "1:115.15.0+build1-0ubuntu0.22.04.1",
        "1:115.16.0+build2-0ubuntu0.22.04.1",
        "1:115.18.0+build1-0ubuntu0.22.04.1"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "thunderbird",
        "purl": "pkg:deb/ubuntu/thunderbird@2:1snap1-0ubuntu3?arch=source&distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "1:115.3.1+build1-0ubuntu1",
        "1:115.4.1+build1-0ubuntu1",
        "1:115.4.3+build1-0ubuntu1",
        "1:115.5.0+build1-0ubuntu1",
        "1:115.5.1+build1-0ubuntu1",
        "1:115.5.2+build2-0ubuntu1",
        "1:115.6.0+build1-0ubuntu1",
        "1:115.6.0+build2-0ubuntu1",
        "1:115.6.1+build1-0ubuntu1",
        "1:115.8.0+build1-0ubuntu1",
        "1:115.8.1+build1+snap2",
        "1:115.8.1+build1+snap3",
        "2:1snap1-0ubuntu1",
        "2:1snap1-0ubuntu3"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2022-24791"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-gwc9-348x-qwv2"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/bytecodealliance/wasmtime/commit/666c2554ea0e1728c35aa41178cf235920db888a"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2022-24791"
    }
  ]
}