{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2022/CVE-2022-21704",
    "author": "Canonical Ltd.",
    "timestamp": "2025-04-23T15:26:43.809401",
    "version": 3
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2022-21704",
        "name": "CVE-2022-21704",
        "description": "log4js-node is a port of log4js to node.js. In affected versions default file permissions for log files created by the file, fileSync and dateFile appenders are world-readable (in unix). This could cause problems if log files contain sensitive information. This would affect any users that have not supplied their own permissions for the files via the mode parameter in the config. Users are advised to update.",
        "aliases": [
          "https://github.com/log4js-node/log4js-node/pull/1141 (v6.4.1)",
          "https://github.com/log4js-node/streamroller/pull/87",
          "https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q",
          "https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640",
          "https://www.cve.org/CVERecord?id=CVE-2022-21704",
          "https://ubuntu.com/security/CVE-2022-21704"
        ]
      },
      "timestamp": "2022-01-19 23:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=source&distro=trusty"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=powerpc"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.9-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=source&distro=xenial"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=powerpc"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=source&distro=bionic"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@0.6.18-1?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is no longer supported. Please upgrade your system."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2022-21704",
        "name": "CVE-2022-21704",
        "description": "log4js-node is a port of log4js to node.js. In affected versions default file permissions for log files created by the file, fileSync and dateFile appenders are world-readable (in unix). This could cause problems if log files contain sensitive information. This would affect any users that have not supplied their own permissions for the files via the mode parameter in the config. Users are advised to update.",
        "aliases": [
          "https://github.com/log4js-node/log4js-node/pull/1141 (v6.4.1)",
          "https://github.com/log4js-node/streamroller/pull/87",
          "https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q",
          "https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640",
          "https://www.cve.org/CVERecord?id=CVE-2022-21704",
          "https://ubuntu.com/security/CVE-2022-21704"
        ]
      },
      "timestamp": "2022-01-19 23:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=source&distro=focal"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.1.0-1?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2022-21704",
        "name": "CVE-2022-21704",
        "description": "log4js-node is a port of log4js to node.js. In affected versions default file permissions for log files created by the file, fileSync and dateFile appenders are world-readable (in unix). This could cause problems if log files contain sensitive information. This would affect any users that have not supplied their own permissions for the files via the mode parameter in the config. Users are advised to update.",
        "aliases": [
          "https://github.com/log4js-node/log4js-node/pull/1141 (v6.4.1)",
          "https://github.com/log4js-node/streamroller/pull/87",
          "https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q",
          "https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640",
          "https://www.cve.org/CVERecord?id=CVE-2022-21704",
          "https://ubuntu.com/security/CVE-2022-21704"
        ]
      },
      "timestamp": "2022-01-19 23:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.4.1+~cs8.3.5-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=source&distro=oracular"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=source&distro=plucky"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/node-log4js@6.9.1+~cs8.4.19-1?arch=s390x"
        }
      ],
      "status": "not_affected",
      "justification": "vulnerable_code_not_present",
      "impact_statement": "This package (for the given release), while related to the CVE in some way, is not affected by the issue. CVE notes should contain further information, if needed."
    }
  ]
}