{
  "schema_version": "1.7.0",
  "id": "UBUNTU-CVE-2021-47005",
  "details": "In the Linux kernel, the following vulnerability has been resolved: PCI: endpoint: Fix NULL pointer dereference for ->get_features() get_features ops of pci_epc_ops may return NULL, causing NULL pointer dereference in pci_epf_test_alloc_space function. Let us add a check for pci_epc_feature pointer in pci_epf_test_bind before we access it to avoid any such NULL pointer dereference and return -ENOTSUPP in case pci_epc_feature is not found. When the patch is not applied and EPC features is not implemented in the platform driver, we see the following dump due to kernel NULL pointer dereference. Call trace:  pci_epf_test_bind+0xf4/0x388  pci_epf_bind+0x3c/0x80  pci_epc_epf_link+0xa8/0xcc  configfs_symlink+0x1a4/0x48c  vfs_symlink+0x104/0x184  do_symlinkat+0x80/0xd4  __arm64_sys_symlinkat+0x1c/0x24  el0_svc_common.constprop.3+0xb8/0x170  el0_svc_handler+0x70/0x88  el0_svc+0x8/0x640 Code: d2800581 b9403ab9 f9404ebb 8b394f60 (f9400400) ---[ end trace a438e3c5a24f9df0 ]---",
  "aliases": [],
  "upstream": [
    "CVE-2021-47005"
  ],
  "related": [],
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
    },
    {
      "type": "Ubuntu",
      "score": "medium"
    }
  ],
  "published": "2024-02-28T09:15:00Z",
  "modified": "2025-08-05T04:46:56Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:20.04:LTS",
        "name": "linux-raspi2",
        "purl": "pkg:deb/ubuntu/linux-raspi2@5.4.0-1006.6?arch=source&distro=esm-infra/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.3.0-1007.8",
        "5.3.0-1014.16",
        "5.3.0-1015.17",
        "5.3.0-1017.19",
        "5.4.0-1004.4",
        "5.4.0-1006.6"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:FIPS-updates:20.04:LTS",
        "name": "linux-aws-fips",
        "purl": "pkg:deb/ubuntu/linux-aws-fips@5.4.0-1148.158+fips1?arch=source&distro=fips-updates/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.4.0-1021.21+fips2",
        "5.4.0-1069.73+fips2",
        "5.4.0-1071.76+fips1",
        "5.4.0-1072.77+fips1",
        "5.4.0-1073.78+fips1",
        "5.4.0-1078.84+fips1",
        "5.4.0-1080.87+fips1",
        "5.4.0-1081.88+fips1",
        "5.4.0-1083.90+fips1",
        "5.4.0-1085.92+fips1",
        "5.4.0-1086.93+fips1",
        "5.4.0-1088.96+fips1",
        "5.4.0-1089.97+fips1",
        "5.4.0-1092.100+fips1",
        "5.4.0-1093.101+fips1",
        "5.4.0-1094.102+fips1",
        "5.4.0-1096.104+fips1",
        "5.4.0-1099.107+fips1",
        "5.4.0-1100.108+fips1",
        "5.4.0-1101.109+fips1",
        "5.4.0-1102.110+fips1",
        "5.4.0-1103.111+fips1",
        "5.4.0-1104.112+fips1",
        "5.4.0-1105.113+fips1",
        "5.4.0-1106.114+fips1",
        "5.4.0-1107.115+fips1",
        "5.4.0-1108.116+fips1",
        "5.4.0-1109.118+fips1",
        "5.4.0-1110.119+fips1",
        "5.4.0-1111.120+fips1",
        "5.4.0-1112.121+fips1",
        "5.4.0-1113.123+fips1",
        "5.4.0-1114.124+fips1",
        "5.4.0-1116.126+fips1",
        "5.4.0-1117.127+fips1",
        "5.4.0-1118.128+fips1",
        "5.4.0-1119.129+fips1",
        "5.4.0-1120.130+fips1",
        "5.4.0-1121.131+fips1",
        "5.4.0-1122.132+fips1",
        "5.4.0-1123.133+fips1",
        "5.4.0-1124.134+fips1",
        "5.4.0-1125.135+fips1",
        "5.4.0-1126.136+fips2",
        "5.4.0-1127.137+fips1",
        "5.4.0-1128.138+fips1",
        "5.4.0-1129.139+fips1",
        "5.4.0-1130.140+fips1",
        "5.4.0-1131.141+fips1",
        "5.4.0-1132.142+fips1",
        "5.4.0-1133.143+fips1",
        "5.4.0-1134.144+fips1",
        "5.4.0-1135.145+fips1",
        "5.4.0-1136.146+fips1",
        "5.4.0-1137.147+fips1",
        "5.4.0-1139.149+fips1",
        "5.4.0-1140.151+fips1",
        "5.4.0-1142.153+fips1",
        "5.4.0-1144.155+fips1",
        "5.4.0-1145.156+fips1",
        "5.4.0-1146.156+fips1",
        "5.4.0-1147.157+fips1",
        "5.4.0-1148.158+fips1"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:FIPS-updates:20.04:LTS",
        "name": "linux-azure-fips",
        "purl": "pkg:deb/ubuntu/linux-azure-fips@5.4.0-1154.161+fips1?arch=source&distro=fips-updates/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.4.0-1022.22+fips1",
        "5.4.0-1073.76+fips1",
        "5.4.0-1074.77+fips1",
        "5.4.0-1076.79+fips1",
        "5.4.0-1078.81+fips1",
        "5.4.0-1080.83+fips1",
        "5.4.0-1083.87+fips1",
        "5.4.0-1085.90+fips1",
        "5.4.0-1086.91+fips1",
        "5.4.0-1089.94+fips1",
        "5.4.0-1090.95+fips1",
        "5.4.0-1091.96+fips1",
        "5.4.0-1094.100+fips1",
        "5.4.0-1095.101+fips1",
        "5.4.0-1098.104+fips1",
        "5.4.0-1100.106+fips1",
        "5.4.0-1101.107+fips1",
        "5.4.0-1103.109+fips1",
        "5.4.0-1104.110+fips1",
        "5.4.0-1105.111+fips1",
        "5.4.0-1106.112+fips1",
        "5.4.0-1107.113+fips1",
        "5.4.0-1108.114+fips1",
        "5.4.0-1109.115+fips1",
        "5.4.0-1110.116+fips1",
        "5.4.0-1111.117+fips1",
        "5.4.0-1112.118+fips1",
        "5.4.0-1113.119+fips1",
        "5.4.0-1114.120+fips1",
        "5.4.0-1115.122+fips1",
        "5.4.0-1116.123+fips1",
        "5.4.0-1117.124+fips1",
        "5.4.0-1118.125+fips1",
        "5.4.0-1119.126+fips1",
        "5.4.0-1121.128+fips1",
        "5.4.0-1122.129+fips1",
        "5.4.0-1123.130+fips1",
        "5.4.0-1124.131+fips1",
        "5.4.0-1126.133+fips1",
        "5.4.0-1127.134+fips1",
        "5.4.0-1128.135+fips1",
        "5.4.0-1129.136+fips1",
        "5.4.0-1130.137+fips1",
        "5.4.0-1131.138+fips1",
        "5.4.0-1132.139+fips1",
        "5.4.0-1133.140+fips1",
        "5.4.0-1134.141+fips1",
        "5.4.0-1135.142+fips1",
        "5.4.0-1136.143+fips1",
        "5.4.0-1137.144+fips1",
        "5.4.0-1138.145+fips1",
        "5.4.0-1139.146+fips1",
        "5.4.0-1140.147+fips1",
        "5.4.0-1142.149+fips1",
        "5.4.0-1143.150+fips1",
        "5.4.0-1145.152+fips1",
        "5.4.0-1147.154+fips1",
        "5.4.0-1148.156+fips1",
        "5.4.0-1149.157+fips1",
        "5.4.0-1151.158+fips1",
        "5.4.0-1152.159+fips1",
        "5.4.0-1153.160+fips1",
        "5.4.0-1154.161+fips1"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:FIPS-updates:20.04:LTS",
        "name": "linux-gcp-fips",
        "purl": "pkg:deb/ubuntu/linux-gcp-fips@5.4.0-1151.160+fips1?arch=source&distro=fips-updates/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.4.0-1021.21+fips1",
        "5.4.0-1067.71~20.04.1",
        "5.4.0-1069.73+fips2",
        "5.4.0-1071.75+fips1",
        "5.4.0-1073.78+fips1",
        "5.4.0-1075.80+fips1",
        "5.4.0-1078.84+fips1",
        "5.4.0-1080.87+fips1",
        "5.4.0-1081.88+fips1",
        "5.4.0-1086.94+fips1",
        "5.4.0-1087.95+fips1",
        "5.4.0-1089.97+fips1",
        "5.4.0-1092.101+fips1",
        "5.4.0-1093.102+fips1",
        "5.4.0-1096.105+fips1",
        "5.4.0-1097.106+fips1",
        "5.4.0-1098.107+fips1",
        "5.4.0-1100.109+fips1",
        "5.4.0-1101.110+fips1",
        "5.4.0-1102.111+fips1",
        "5.4.0-1103.112+fips1",
        "5.4.0-1104.113+fips1",
        "5.4.0-1105.114+fips1",
        "5.4.0-1106.115+fips1",
        "5.4.0-1107.116+fips1",
        "5.4.0-1108.117+fips1",
        "5.4.0-1109.118+fips1",
        "5.4.0-1110.119+fips1",
        "5.4.0-1111.120+fips1",
        "5.4.0-1112.121+fips1",
        "5.4.0-1113.122+fips1",
        "5.4.0-1115.124+fips1",
        "5.4.0-1116.125+fips1",
        "5.4.0-1117.126+fips1",
        "5.4.0-1118.127+fips1",
        "5.4.0-1120.129+fips1",
        "5.4.0-1121.130+fips1",
        "5.4.0-1122.131+fips1",
        "5.4.0-1124.133+fips1",
        "5.4.0-1125.134+fips1",
        "5.4.0-1126.135+fips1",
        "5.4.0-1127.136+fips1",
        "5.4.0-1128.137+fips1",
        "5.4.0-1129.138+fips1",
        "5.4.0-1130.139+fips1",
        "5.4.0-1131.140+fips1",
        "5.4.0-1132.141+fips1",
        "5.4.0-1133.142+fips1",
        "5.4.0-1134.143+fips1",
        "5.4.0-1135.144+fips1",
        "5.4.0-1136.145+fips1",
        "5.4.0-1137.146+fips1",
        "5.4.0-1138.147+fips1",
        "5.4.0-1139.148+fips1",
        "5.4.0-1140.149+fips1",
        "5.4.0-1141.150+fips1",
        "5.4.0-1142.151+fips1",
        "5.4.0-1143.152+fips1",
        "5.4.0-1145.154+fips1",
        "5.4.0-1146.155+fips1",
        "5.4.0-1147.156+fips1",
        "5.4.0-1148.157+fips1",
        "5.4.0-1149.158+fips1",
        "5.4.0-1150.159+fips1",
        "5.4.0-1151.160+fips1"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:FIPS:20.04:LTS",
        "name": "linux-aws-fips",
        "purl": "pkg:deb/ubuntu/linux-aws-fips@5.4.0-1021.21+fips2?arch=source&distro=fips/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.4.0-1021.21+fips2"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:FIPS:20.04:LTS",
        "name": "linux-azure-fips",
        "purl": "pkg:deb/ubuntu/linux-azure-fips@5.4.0-1022.22+fips1?arch=source&distro=fips/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.4.0-1022.22+fips1"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:FIPS:20.04:LTS",
        "name": "linux-gcp-fips",
        "purl": "pkg:deb/ubuntu/linux-gcp-fips@5.4.0-1021.21+fips1?arch=source&distro=fips/focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.4.0-1021.21+fips1"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "linux-intel-iot-realtime",
        "purl": "pkg:deb/ubuntu/linux-intel-iot-realtime@5.15.0-1073.75?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.15.0-1073.75"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "linux-realtime",
        "purl": "pkg:deb/ubuntu/linux-realtime@5.15.0-1032.35?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "5.15.0-1032.35"
      ],
      "ecosystem_specific": {}
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "linux-raspi-realtime",
        "purl": "pkg:deb/ubuntu/linux-raspi-realtime@6.8.0-2019.20?arch=source&distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "6.8.0-2019.20"
      ],
      "ecosystem_specific": {}
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2021-47005"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/linus/6613bc2301ba291a1c5a90e1dc24cf3edf223c03"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/bbed83d7060e07a5d309104d25a00f0a24441428"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/679ebad058b8168f10e63876d63b0877fd2fe784"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/0169d4f0bee44fdfef908c13ed21fcb326c38695"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/6613bc2301ba291a1c5a90e1dc24cf3edf223c03"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2021-47005"
    }
  ]
}