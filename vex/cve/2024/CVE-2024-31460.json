{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2024/CVE-2024-31460",
    "author": "Canonical Ltd.",
    "timestamp": "2024-12-20T16:38:00.291578",
    "version": 2
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2024-31460",
        "name": "CVE-2024-31460",
        "description": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, some of the data stored in `automation_tree_rules.php` is not thoroughly checked and is used to concatenate the SQL statement in `create_all_header_nodes()` function from `lib/api_automation.php` , finally resulting in SQL injection. Using SQL based secondary injection technology, attackers can modify the contents of the Cacti database, and based on the modified content, it may be possible to achieve further impact, such as arbitrary file reading, and even remote code execution through arbitrary file writing. Version 1.2.27 contains a patch for the issue.",
        "aliases": [
          "https://www.cve.org/CVERecord?id=CVE-2024-31460",
          "https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r",
          "https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv",
          "https://ubuntu.com/security/notices/USN-6969-1",
          "https://ubuntu.com/security/CVE-2024-31460"
        ]
      },
      "timestamp": "2024-05-14 15:25:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=src?distro=esm-apps/bionic"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.1.38+ds1-1ubuntu0.1~esm3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=src?distro=ubuntu/focal"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.10+ds1-1ubuntu1.1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=src?distro=ubuntu/jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.19+ds1-2ubuntu1.1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=src?distro=ubuntu/noble"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@1.2.26+ds1-1ubuntu0.1?arch=s390x"
        }
      ],
      "status": "fixed",
      "status_notes": "This package (for the given release) was vulnerable, but an update has been uploaded and published."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2024-31460",
        "name": "CVE-2024-31460",
        "description": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, some of the data stored in `automation_tree_rules.php` is not thoroughly checked and is used to concatenate the SQL statement in `create_all_header_nodes()` function from `lib/api_automation.php` , finally resulting in SQL injection. Using SQL based secondary injection technology, attackers can modify the contents of the Cacti database, and based on the modified content, it may be possible to achieve further impact, such as arbitrary file reading, and even remote code execution through arbitrary file writing. Version 1.2.27 contains a patch for the issue.",
        "aliases": [
          "https://www.cve.org/CVERecord?id=CVE-2024-31460",
          "https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r",
          "https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv",
          "https://ubuntu.com/security/notices/USN-6969-1",
          "https://ubuntu.com/security/CVE-2024-31460"
        ]
      },
      "timestamp": "2024-05-14 15:25:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8b+dfsg-5ubuntu0.2+esm2?arch=src?distro=esm-infra-legacy/trusty"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8b+dfsg-5ubuntu0.2+esm2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8b+dfsg-5ubuntu0.2+esm2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8b+dfsg-5ubuntu0.2+esm2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8b+dfsg-5ubuntu0.2+esm2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8b+dfsg-5ubuntu0.2+esm2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=src?distro=esm-apps/xenial"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/cacti@0.8.8f+ds1-4ubuntu4.16.04.2+esm2?arch=s390x"
        }
      ],
      "status": "not_affected",
      "justification": "vulnerable_code_not_present",
      "impact_statement": "This package (for the given release), while related to the CVE in some way, is not affected by the issue. CVE notes should contain further information, if needed."
    }
  ]
}