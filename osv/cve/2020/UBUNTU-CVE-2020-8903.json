{
  "schema_version": "1.6.3",
  "id": "UBUNTU-CVE-2020-8903",
  "details": "A vulnerability in Google Cloud Platform's guest-oslogin versions between 20190304 and 20200507 allows a user that is only granted the role \"roles/compute.osLogin\" to escalate privileges to root. Using their membership to the \"adm\" group, users with this role are able to read the DHCP XID from the systemd journal. Using the DHCP XID, it is then possible to set the IP address and hostname of the instance to any value, which is then stored in /etc/hosts. An attacker can then point metadata.google.internal to an arbitrary IP address and impersonate the GCE metadata server which make it is possible to instruct the OS Login PAM module to grant administrative privileges. All images created after 2020-May-07 (20200507) are fixed, and if you cannot update, we recommend you edit /etc/group/security.conf and remove the \"adm\" user from the OS Login entry.",
  "aliases": [],
  "related": [
    "CVE-2020-8903"
  ],
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "published": "2020-06-22T14:15:00Z",
  "modified": "2024-12-18T16:36:01Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:14.04:LTS",
        "name": "gce-compute-image-packages",
        "purl": "pkg:deb/ubuntu/gce-compute-image-packages?arch=src?distro=esm-infra-legacy/trusty"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "20160930-0ubuntu3~14.04.0",
        "20160930-0ubuntu3~14.04.1",
        "20160930-0ubuntu3~14.04.2",
        "20160930-0ubuntu6~14.04.0",
        "20170426-0ubuntu2~14.04.0",
        "20170523-0ubuntu1~14.04.0",
        "20170622-0ubuntu1~14.04.0",
        "20170718-0ubuntu1~14.04.0",
        "20171019+dfsg1-0ubuntu1~14.04.0",
        "20171025+dfsg1-0ubuntu1~14.04.0",
        "20171129+dfsg1-0ubuntu1~14.04.0",
        "20180129+dfsg1-0ubuntu1~14.04.0",
        "20180510+dfsg1-0ubuntu3~14.04.3",
        "20180905+dfsg1-0ubuntu1~14.04.0",
        "20180905+dfsg1-0ubuntu1~14.04.1",
        "20190124+dfsg1-0ubuntu1~14.04.0",
        "20190315-0ubuntu1~14.04.0"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:16.04:LTS",
        "name": "gce-compute-image-packages",
        "purl": "pkg:deb/ubuntu/gce-compute-image-packages?arch=src?distro=xenial"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "20190801-0ubuntu1~16.04.1"
            }
          ]
        }
      ],
      "versions": [
        "20160930-0ubuntu3~16.04.0",
        "20160930-0ubuntu5~16.04.0",
        "20160930-0ubuntu6~16.04.0",
        "20170426-0ubuntu2~16.04.0",
        "20170523-0ubuntu1~16.04.0",
        "20170622-0ubuntu1~16.04.0",
        "20170718-0ubuntu1~16.04.0",
        "20171019+dfsg1-0ubuntu1~16.04.0",
        "20171025+dfsg1-0ubuntu1~16.04.0",
        "20171129+dfsg1-0ubuntu1~16.04.0",
        "20180129+dfsg1-0ubuntu1~16.04.0",
        "20180510+dfsg1-0ubuntu3~16.04.0",
        "20180510+dfsg1-0ubuntu3~16.04.1",
        "20180905+dfsg1-0ubuntu1~16.04.0",
        "20180905+dfsg1-0ubuntu1~16.04.1",
        "20190124+dfsg1-0ubuntu1~16.04.0",
        "20190522-0ubuntu1~16.04.0",
        "20190801-0ubuntu1~16.04.0"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "gce-compute-image-packages",
            "binary_version": "20190801-0ubuntu1~16.04.1"
          },
          {
            "binary_name": "google-compute-engine-oslogin",
            "binary_version": "20190801-0ubuntu1~16.04.1"
          },
          {
            "binary_name": "google-compute-engine-oslogin-dbgsym",
            "binary_version": "20190801-0ubuntu1~16.04.1"
          },
          {
            "binary_name": "python-google-compute-engine",
            "binary_version": "20190801-0ubuntu1~16.04.1"
          },
          {
            "binary_name": "python3-google-compute-engine",
            "binary_version": "20190801-0ubuntu1~16.04.1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:18.04:LTS",
        "name": "gce-compute-image-packages",
        "purl": "pkg:deb/ubuntu/gce-compute-image-packages?arch=src?distro=bionic"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "20190801-0ubuntu1~18.04.1"
            }
          ]
        }
      ],
      "versions": [
        "20171006+dfsg1-0ubuntu1",
        "20171019+dfsg1-0ubuntu1",
        "20171025+dfsg1-0ubuntu1",
        "20171129+dfsg1-0ubuntu1",
        "20180129+dfsg1-0ubuntu1",
        "20180129+dfsg1-0ubuntu2",
        "20180129+dfsg1-0ubuntu3",
        "20180510+dfsg1-0ubuntu4~18.04.0",
        "20180510+dfsg1-0ubuntu4~18.04.1",
        "20180905+dfsg1-0ubuntu1~18.04.0",
        "20190124+dfsg1-0ubuntu1~18.04.0",
        "20190522-0ubuntu1~18.04.0",
        "20190801-0ubuntu1~18.04.0"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "gce-compute-image-packages",
            "binary_version": "20190801-0ubuntu1~18.04.1"
          },
          {
            "binary_name": "google-compute-engine-oslogin",
            "binary_version": "20190801-0ubuntu1~18.04.1"
          },
          {
            "binary_name": "google-compute-engine-oslogin-dbgsym",
            "binary_version": "20190801-0ubuntu1~18.04.1"
          },
          {
            "binary_name": "python-google-compute-engine",
            "binary_version": "20190801-0ubuntu1~18.04.1"
          },
          {
            "binary_name": "python3-google-compute-engine",
            "binary_version": "20190801-0ubuntu1~18.04.1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:20.04:LTS",
        "name": "gce-compute-image-packages",
        "purl": "pkg:deb/ubuntu/gce-compute-image-packages?arch=src?distro=focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "20190801-0ubuntu4.1"
            }
          ]
        }
      ],
      "versions": [
        "20190801-0ubuntu1",
        "20190801-0ubuntu2",
        "20190801-0ubuntu3",
        "20190801-0ubuntu4"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "gce-compute-image-packages",
            "binary_version": "20190801-0ubuntu4.1"
          },
          {
            "binary_name": "google-compute-engine-oslogin",
            "binary_version": "20190801-0ubuntu4.1"
          },
          {
            "binary_name": "google-compute-engine-oslogin-dbgsym",
            "binary_version": "20190801-0ubuntu4.1"
          },
          {
            "binary_name": "python3-google-compute-engine",
            "binary_version": "20190801-0ubuntu4.1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2020-8903"
    },
    {
      "type": "REPORT",
      "url": "https://cloud.google.com/support/bulletins/#gcp-2020-008"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/GoogleCloudPlatform/guest-oslogin/pull/29"
    },
    {
      "type": "REPORT",
      "url": "https://gitlab.com/gitlab-com/gl-security/gl-redteam/red-team-tech-notes/-/tree/master/oslogin-privesc-june-2020"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2020-8903"
    }
  ]
}