{
  "schema_version": "1.6.3",
  "id": "UBUNTU-CVE-2023-38545",
  "details": "This flaw makes curl overflow a heap based buffer in the SOCKS5 proxy handshake. When curl is asked to pass along the host name to the SOCKS5 proxy to allow that to resolve the address instead of it getting done by curl itself, the maximum length that host name can be is 255 bytes. If the host name is detected to be longer, curl switches to local name resolving and instead passes on the resolved address only. Due to this bug, the local variable that means \"let the host resolve the name\" could get the wrong value during a slow SOCKS5 handshake, and contrary to the intention, copy the too long host name to the target buffer instead of copying just the resolved address there. The target buffer being a heap based buffer, and the host name coming from the URL that curl has been told to operate with.",
  "aliases": [],
  "related": [
    "CVE-2023-38545",
    "USN-6429-1",
    "USN-6429-3"
  ],
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    }
  ],
  "published": "2023-10-11T06:00:00Z",
  "modified": "2024-11-20T12:17:04Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:20.04:LTS",
        "name": "curl",
        "purl": "pkg:deb/ubuntu/curl?arch=src?distro=focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "7.68.0-1ubuntu2.19"
            }
          ]
        }
      ],
      "versions": [
        "7.65.3-1ubuntu3",
        "7.65.3-1ubuntu4",
        "7.66.0-1ubuntu1",
        "7.67.0-2ubuntu1",
        "7.68.0-1ubuntu1",
        "7.68.0-1ubuntu2",
        "7.68.0-1ubuntu2.1",
        "7.68.0-1ubuntu2.2",
        "7.68.0-1ubuntu2.4",
        "7.68.0-1ubuntu2.5",
        "7.68.0-1ubuntu2.6",
        "7.68.0-1ubuntu2.7",
        "7.68.0-1ubuntu2.10",
        "7.68.0-1ubuntu2.11",
        "7.68.0-1ubuntu2.12",
        "7.68.0-1ubuntu2.13",
        "7.68.0-1ubuntu2.14",
        "7.68.0-1ubuntu2.15",
        "7.68.0-1ubuntu2.16",
        "7.68.0-1ubuntu2.18"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "curl",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "curl-dbgsym",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl3-gnutls",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl3-gnutls-dbgsym",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl3-nss",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl3-nss-dbgsym",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl4",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl4-dbgsym",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl4-doc",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl4-gnutls-dev",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl4-nss-dev",
            "binary_version": "7.68.0-1ubuntu2.19"
          },
          {
            "binary_name": "libcurl4-openssl-dev",
            "binary_version": "7.68.0-1ubuntu2.19"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "high",
        "priority_reason": "Upstream curl developer has rated this issue as high"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "curl",
        "purl": "pkg:deb/ubuntu/curl?arch=src?distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "7.81.0-1ubuntu1.14"
            }
          ]
        }
      ],
      "versions": [
        "7.74.0-1.3ubuntu2",
        "7.74.0-1.3ubuntu3",
        "7.80.0-3",
        "7.81.0-1",
        "7.81.0-1ubuntu1.1",
        "7.81.0-1ubuntu1.2",
        "7.81.0-1ubuntu1.3",
        "7.81.0-1ubuntu1.4",
        "7.81.0-1ubuntu1.6",
        "7.81.0-1ubuntu1.7",
        "7.81.0-1ubuntu1.8",
        "7.81.0-1ubuntu1.10",
        "7.81.0-1ubuntu1.11",
        "7.81.0-1ubuntu1.13"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "curl",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "curl-dbgsym",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl3-gnutls",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl3-gnutls-dbgsym",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl3-nss",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl3-nss-dbgsym",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl4",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl4-dbgsym",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl4-doc",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl4-gnutls-dev",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl4-nss-dev",
            "binary_version": "7.81.0-1ubuntu1.14"
          },
          {
            "binary_name": "libcurl4-openssl-dev",
            "binary_version": "7.81.0-1ubuntu1.14"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "high",
        "priority_reason": "Upstream curl developer has rated this issue as high"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "curl",
        "purl": "pkg:deb/ubuntu/curl?arch=src?distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "8.2.1-1ubuntu3.1"
            }
          ]
        }
      ],
      "versions": [
        "8.2.1-1ubuntu3"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "curl",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "curl-dbgsym",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl3-gnutls",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl3-gnutls-dbgsym",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl3-nss",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl3-nss-dbgsym",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl4",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl4-dbgsym",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl4-doc",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl4-gnutls-dev",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl4-nss-dev",
            "binary_version": "8.2.1-1ubuntu3.1"
          },
          {
            "binary_name": "libcurl4-openssl-dev",
            "binary_version": "8.2.1-1ubuntu3.1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "high",
        "priority_reason": "Upstream curl developer has rated this issue as high"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2023-38545"
    },
    {
      "type": "REPORT",
      "url": "https://curl.se/docs/CVE-2023-38545.html"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/notices/USN-6429-1"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/notices/USN-6429-3"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2023-38545"
    }
  ]
}