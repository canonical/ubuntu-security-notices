{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2023/CVE-2023-38710",
    "author": "Canonical Ltd.",
    "timestamp": "2025-01-13T12:16:53.500593",
    "version": 2
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-38710",
        "name": "CVE-2023-38710",
        "description": "An issue was discovered in Libreswan before 4.12. When an IKEv2 Child SA REKEY packet contains an invalid IPsec protocol ID number of 0 or 1, an error notify INVALID_SPI is sent back. The notify payload's protocol ID is copied from the incoming packet, but the code that verifies outgoing packets fails an assertion that the protocol ID must be ESP (2) or AH(3) and causes the pluto daemon to crash and restart. NOTE: the earliest affected version is 3.20.",
        "aliases": [
          "https://libreswan.org/security/CVE-2023-38710/CVE-2023-38710.txt",
          "https://libreswan.org/security/CVE-2023-38710/CVE-2023-38710.patch",
          "https://www.cve.org/CVERecord?id=CVE-2023-38710",
          "https://ubuntu.com/security/CVE-2023-38710"
        ]
      },
      "timestamp": "2023-08-25 21:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=source&distro=bionic"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.23-4?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.23-4?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.23-4?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.23-4?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.23-4?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.23-4?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.23-4?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is no longer supported. Please upgrade your system."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-38710",
        "name": "CVE-2023-38710",
        "description": "An issue was discovered in Libreswan before 4.12. When an IKEv2 Child SA REKEY packet contains an invalid IPsec protocol ID number of 0 or 1, an error notify INVALID_SPI is sent back. The notify payload's protocol ID is copied from the incoming packet, but the code that verifies outgoing packets fails an assertion that the protocol ID must be ESP (2) or AH(3) and causes the pluto daemon to crash and restart. NOTE: the earliest affected version is 3.20.",
        "aliases": [
          "https://libreswan.org/security/CVE-2023-38710/CVE-2023-38710.txt",
          "https://libreswan.org/security/CVE-2023-38710/CVE-2023-38710.patch",
          "https://www.cve.org/CVERecord?id=CVE-2023-38710",
          "https://ubuntu.com/security/CVE-2023-38710"
        ]
      },
      "timestamp": "2023-08-25 21:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=source&distro=focal"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.29-2build1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.29-2build1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@3.32-3ubuntu3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.32-3ubuntu3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.32-3ubuntu3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.32-3ubuntu3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.32-3ubuntu3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.32-3ubuntu3?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@3.32-3ubuntu3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=source&distro=oracular"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan@4.14-1ubuntu2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libreswan-dbgsym@4.14-1ubuntu2?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    }
  ]
}