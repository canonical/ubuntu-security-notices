{
  "schema_version": "1.6.3",
  "id": "UBUNTU-CVE-2023-22466",
  "details": "Tokio is a runtime for writing applications with Rust. Starting with version 1.7.0 and prior to versions 1.18.4, 1.20.3, and 1.23.1, when configuring a Windows named pipe server, setting `pipe_mode` will reset `reject_remote_clients` to `false`. If the application has previously configured `reject_remote_clients` to `true`, this effectively undoes the configuration. Remote clients may only access the named pipe if the named pipe's associated path is accessible via a publicly shared folder (SMB). Versions 1.23.1, 1.20.3, and 1.18.4 have been patched. The fix will also be present in all releases starting from version 1.24.0. Named pipes were introduced to Tokio in version 1.7.0, so releases older than 1.7.0 are not affected. As a workaround, ensure that `pipe_mode` is set first after initializing a `ServerOptions`.",
  "aliases": [],
  "related": [
    "CVE-2023-22466"
  ],
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N"
    }
  ],
  "published": "2023-01-04T22:15:00Z",
  "modified": "2025-01-13T10:24:17Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:20.04:LTS",
        "name": "rust-tokio",
        "purl": "pkg:deb/ubuntu/rust-tokio@0.1.14-2build1?arch=source&distro=focal"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.1.14-2build1"
            }
          ]
        }
      ],
      "versions": [
        "0.1.14-2"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "librust-tokio+async-await-preview-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+bytes-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+codec-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+default-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+fs-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+io-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+mio-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+num-cpus-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+reactor-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+rt-full-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tcp-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+timer-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-async-await-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-codec-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-current-thread-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-executor-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-fs-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-io-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-reactor-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-tcp-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-threadpool-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-timer-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-udp-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+tokio-uds-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+udp-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio+uds-dev",
            "binary_version": "0.1.14-2build1"
          },
          {
            "binary_name": "librust-tokio-dev",
            "binary_version": "0.1.14-2build1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "rust-tokio",
        "purl": "pkg:deb/ubuntu/rust-tokio@1.15.0-1?arch=source&distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "0.1.14-2build1",
        "1.15.0-1"
      ],
      "ecosystem_specific": {
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.10",
        "name": "rust-tokio",
        "purl": "pkg:deb/ubuntu/rust-tokio@1.39.3-3?arch=source&distro=oracular"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.39.3-3"
            }
          ]
        }
      ],
      "versions": [
        "1.35.1-1"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "librust-tokio-dev",
            "binary_version": "1.39.3-3"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "rust-tokio",
        "purl": "pkg:deb/ubuntu/rust-tokio@1.35.1-1?arch=source&distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.35.1-1"
            }
          ]
        }
      ],
      "versions": [
        "1.29.1-1",
        "1.33.0-1"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "binary_name": "librust-tokio-dev",
            "binary_version": "1.35.1-1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2023-22466"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/tokio-rs/tokio/pull/5336"
    },
    {
      "type": "REPORT",
      "url": "https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-createnamedpipea#pipe_reject_remote_clients"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/tokio-rs/tokio/security/advisories/GHSA-7rrj-xr53-82p7"
    },
    {
      "type": "REPORT",
      "url": "https://github.com/tokio-rs/tokio/releases/tag/tokio-1.23.1"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2023-22466"
    }
  ]
}