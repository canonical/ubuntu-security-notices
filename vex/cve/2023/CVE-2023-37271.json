{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2023/CVE-2023-37271",
    "author": "Canonical Ltd.",
    "timestamp": "2024-10-15T14:38:45.558067",
    "version": 1
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-37271",
        "name": "CVE-2023-37271",
        "description": "RestrictedPython is a tool that helps to define a subset of the Python language which allows users to provide a program input into a trusted environment. RestrictedPython does not check access to stack frames and their attributes. Stack frames are accessible within at least generators and generator expressions, which are allowed inside RestrictedPython. Prior to versions 6.1 and 5.3, an attacker with access to a RestrictedPython environment can write code that gets the current stack frame in a generator and then walk the stack all the way beyond the RestrictedPython invocation boundary, thus breaking out of the restricted sandbox and potentially allowing arbitrary code execution in the Python interpreter. All RestrictedPython deployments that allow untrusted users to write Python code in the RestrictedPython environment are at risk. In terms of Zope and Plone, this would mean deployments where the administrator allows untrusted users to create and/or edit objects of type `Script (Python)`, `DTML Method`, `DTML Document` or `Zope Page Template`. This is a non-default configuration and likely to be extremely rare. The problem has been fixed in versions 6.1 and 5.3.",
        "aliases": [
          "https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh",
          "https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531",
          "https://www.cve.org/CVERecord?id=CVE-2023-37271",
          "https://ubuntu.com/security/CVE-2023-37271"
        ]
      },
      "timestamp": "2023-07-11 18:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@4.0~b3-2?arch=src?distro=ubuntu/focal"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@4.0~b3-3?arch=src?distro=ubuntu/jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@4.0~b3-3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@6.2-1?arch=src?distro=ubuntu/oracular"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@6.2-1?arch=src?distro=ubuntu/noble"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-restrictedpython@6.2-1?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-37271",
        "name": "CVE-2023-37271",
        "description": "RestrictedPython is a tool that helps to define a subset of the Python language which allows users to provide a program input into a trusted environment. RestrictedPython does not check access to stack frames and their attributes. Stack frames are accessible within at least generators and generator expressions, which are allowed inside RestrictedPython. Prior to versions 6.1 and 5.3, an attacker with access to a RestrictedPython environment can write code that gets the current stack frame in a generator and then walk the stack all the way beyond the RestrictedPython invocation boundary, thus breaking out of the restricted sandbox and potentially allowing arbitrary code execution in the Python interpreter. All RestrictedPython deployments that allow untrusted users to write Python code in the RestrictedPython environment are at risk. In terms of Zope and Plone, this would mean deployments where the administrator allows untrusted users to create and/or edit objects of type `Script (Python)`, `DTML Method`, `DTML Document` or `Zope Page Template`. This is a non-default configuration and likely to be extremely rare. The problem has been fixed in versions 6.1 and 5.3.",
        "aliases": [
          "https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh",
          "https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531",
          "https://www.cve.org/CVERecord?id=CVE-2023-37271",
          "https://ubuntu.com/security/CVE-2023-37271"
        ]
      },
      "timestamp": "2023-07-11 18:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@3.6.0-0ubuntu4?arch=src?distro=ubuntu/trusty"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=powerpc"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@3.6.0-0ubuntu4?arch=src?distro=ubuntu/xenial"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=powerpc"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/restrictedpython@3.6.0-0ubuntu4?arch=src?distro=ubuntu/bionic"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python-restrictedpython@3.6.0-0ubuntu4?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is no longer supported. Please upgrade your system."
    }
  ]
}