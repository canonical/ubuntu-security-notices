{
  "schema_version": "1.6.3",
  "id": "CVE-2021-47005",
  "details": "In the Linux kernel, the following vulnerability has been resolved: PCI: endpoint: Fix NULL pointer dereference for ->get_features() get_features ops of pci_epc_ops may return NULL, causing NULL pointer dereference in pci_epf_test_alloc_space function. Let us add a check for pci_epc_feature pointer in pci_epf_test_bind before we access it to avoid any such NULL pointer dereference and return -ENOTSUPP in case pci_epc_feature is not found. When the patch is not applied and EPC features is not implemented in the platform driver, we see the following dump due to kernel NULL pointer dereference. Call trace: pci_epf_test_bind+0xf4/0x388 pci_epf_bind+0x3c/0x80 pci_epc_epf_link+0xa8/0xcc configfs_symlink+0x1a4/0x48c vfs_symlink+0x104/0x184 do_symlinkat+0x80/0xd4 __arm64_sys_symlinkat+0x1c/0x24 el0_svc_common.constprop.3+0xb8/0x170 el0_svc_handler+0x70/0x88 el0_svc+0x8/0x640 Code: d2800581 b9403ab9 f9404ebb 8b394f60 (f9400400) ---[ end trace a438e3c5a24f9df0 ]---",
  "aliases": [],
  "related": [],
  "published": "2024-02-28T09:15:00Z",
  "modified": "2024-02-28T09:15:00Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "linux-nvidia-6.5",
        "purl": "pkg:deb/ubuntu/linux-nvidia-6.5@6.5.0-1004.4?arch=src?distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.5.0-1004.4"
            }
          ]
        }
      ],
      "versions": [],
      "ecosystem_specific": {
        "binaries": [
          {
            "linux-buildinfo-6.5.0-1004-nvidia": "6.5.0-1004.4",
            "linux-buildinfo-6.5.0-1004-nvidia-64k": "6.5.0-1004.4",
            "linux-headers-6.5.0-1004-nvidia": "6.5.0-1004.4",
            "linux-headers-6.5.0-1004-nvidia-64k": "6.5.0-1004.4",
            "linux-image-unsigned-6.5.0-1004-nvidia": "6.5.0-1004.4",
            "linux-image-unsigned-6.5.0-1004-nvidia-64k": "6.5.0-1004.4",
            "linux-image-unsigned-6.5.0-1004-nvidia-64k-dbgsym": "6.5.0-1004.4",
            "linux-image-unsigned-6.5.0-1004-nvidia-dbgsym": "6.5.0-1004.4",
            "linux-modules-6.5.0-1004-nvidia": "6.5.0-1004.4",
            "linux-modules-6.5.0-1004-nvidia-64k": "6.5.0-1004.4",
            "linux-modules-extra-6.5.0-1004-nvidia": "6.5.0-1004.4",
            "linux-nvidia-6.5-headers-6.5.0-1004": "6.5.0-1004.4",
            "linux-nvidia-6.5-tools-6.5.0-1004": "6.5.0-1004.4",
            "linux-nvidia-6.5-tools-host": "6.5.0-1004.4",
            "linux-tools-6.5.0-1004-nvidia": "6.5.0-1004.4",
            "linux-tools-6.5.0-1004-nvidia-64k": "6.5.0-1004.4"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:22.04:LTS",
        "name": "linux-oracle-6.5",
        "purl": "pkg:deb/ubuntu/linux-oracle-6.5@6.5.0-1013.13~22.04.4?arch=src?distro=jammy"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.5.0-1013.13~22.04.4"
            }
          ]
        }
      ],
      "versions": [],
      "ecosystem_specific": {
        "binaries": [
          {
            "linux-buildinfo-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4",
            "linux-headers-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4",
            "linux-image-unsigned-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4",
            "linux-image-unsigned-6.5.0-1013-oracle-dbgsym": "6.5.0-1013.13~22.04.4",
            "linux-modules-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4",
            "linux-modules-extra-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4",
            "linux-modules-iwlwifi-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4",
            "linux-oracle-6.5-headers-6.5.0-1013": "6.5.0-1013.13~22.04.4",
            "linux-oracle-6.5-tools-6.5.0-1013": "6.5.0-1013.13~22.04.4",
            "linux-tools-6.5.0-1013-oracle": "6.5.0-1013.13~22.04.4"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "linux-gke",
        "purl": "pkg:deb/ubuntu/linux-gke@6.8.0-1003.5?arch=src?distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.0-1003.5"
            }
          ]
        }
      ],
      "versions": [],
      "ecosystem_specific": {
        "binaries": [
          {
            "linux-buildinfo-6.8.0-1003-gke": "6.8.0-1003.5",
            "linux-gke-headers-6.8.0-1003": "6.8.0-1003.5",
            "linux-gke-tools-6.8.0-1003": "6.8.0-1003.5",
            "linux-headers-6.8.0-1003-gke": "6.8.0-1003.5",
            "linux-image-unsigned-6.8.0-1003-gke": "6.8.0-1003.5",
            "linux-image-unsigned-6.8.0-1003-gke-dbgsym": "6.8.0-1003.5",
            "linux-modules-6.8.0-1003-gke": "6.8.0-1003.5",
            "linux-modules-extra-6.8.0-1003-gke": "6.8.0-1003.5",
            "linux-tools-6.8.0-1003-gke": "6.8.0-1003.5"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "linux-nvidia",
        "purl": "pkg:deb/ubuntu/linux-nvidia@6.8.0-1007.7?arch=src?distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.0-1007.7"
            }
          ]
        }
      ],
      "versions": [],
      "ecosystem_specific": {
        "binaries": [
          {
            "linux-buildinfo-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-buildinfo-6.8.0-1007-nvidia-64k": "6.8.0-1007.7",
            "linux-headers-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-headers-6.8.0-1007-nvidia-64k": "6.8.0-1007.7",
            "linux-image-unsigned-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-image-unsigned-6.8.0-1007-nvidia-64k": "6.8.0-1007.7",
            "linux-image-unsigned-6.8.0-1007-nvidia-64k-dbgsym": "6.8.0-1007.7",
            "linux-image-unsigned-6.8.0-1007-nvidia-dbgsym": "6.8.0-1007.7",
            "linux-modules-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-modules-6.8.0-1007-nvidia-64k": "6.8.0-1007.7",
            "linux-modules-extra-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-modules-nvidia-fs-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-modules-nvidia-fs-6.8.0-1007-nvidia-64k": "6.8.0-1007.7",
            "linux-nvidia-headers-6.8.0-1007": "6.8.0-1007.7",
            "linux-nvidia-tools-6.8.0-1007": "6.8.0-1007.7",
            "linux-nvidia-tools-host": "6.8.0-1007.7",
            "linux-tools-6.8.0-1007-nvidia": "6.8.0-1007.7",
            "linux-tools-6.8.0-1007-nvidia-64k": "6.8.0-1007.7"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:24.04:LTS",
        "name": "linux-oem-6.8",
        "purl": "pkg:deb/ubuntu/linux-oem-6.8@6.8.0-1003.3?arch=src?distro=noble"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.0-1003.3"
            }
          ]
        }
      ],
      "versions": [],
      "ecosystem_specific": {
        "binaries": [
          {
            "linux-buildinfo-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-headers-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-image-unsigned-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-image-unsigned-6.8.0-1003-oem-dbgsym": "6.8.0-1003.3",
            "linux-modules-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-modules-ipu6-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-modules-ivsc-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-modules-iwlwifi-6.8.0-1003-oem": "6.8.0-1003.3",
            "linux-oem-6.8-headers-6.8.0-1003": "6.8.0-1003.3",
            "linux-oem-6.8-tools-6.8.0-1003": "6.8.0-1003.3",
            "linux-tools-6.8.0-1003-oem": "6.8.0-1003.3"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2021-47005"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/linus/6613bc2301ba291a1c5a90e1dc24cf3edf223c03"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/bbed83d7060e07a5d309104d25a00f0a24441428"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/679ebad058b8168f10e63876d63b0877fd2fe784"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/0169d4f0bee44fdfef908c13ed21fcb326c38695"
    },
    {
      "type": "REPORT",
      "url": "https://git.kernel.org/stable/c/6613bc2301ba291a1c5a90e1dc24cf3edf223c03"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2021-47005"
    }
  ]
}