{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2023/CVE-2023-46129",
    "author": "Canonical Ltd.",
    "timestamp": "2025-09-02T17:26:56.256030",
    "version": 9
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-46129",
        "name": "CVE-2023-46129",
        "description": "NATS.io is a high performance open source pub-sub distributed communication technology, built for the cloud, on-premise, IoT, and edge computing. The cryptographic key handling library, nkeys, recently gained support for encryption, not just for signing/authentication. This is used in nats-server 2.10 (Sep 2023) and newer for authentication callouts. In nkeys versions 0.4.0 through 0.4.5, corresponding with NATS server versions 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption handling logic mistakenly passed an array by value into an internal function, where the function mutated that buffer to populate the encryption key to use. As a result, all encryption was actually to an all-zeros key. This affects encryption only, not signing. FIXME: FILL IN IMPACT ON NATS-SERVER AUTH CALLOUT SECURITY. nkeys Go library 0.4.6, corresponding with NATS Server 2.10.4, has a patch for this issue. No known workarounds are available. For any application handling auth callouts in Go, if using the nkeys library, update the dependency, recompile and deploy that in lockstep.",
        "aliases": [
          "https://advisories.nats.io/CVE/secnote-2023-02.txt",
          "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9",
          "https://www.cve.org/CVERecord?id=CVE-2023-46129",
          "https://ubuntu.com/security/CVE-2023-46129"
        ]
      },
      "timestamp": "2023-10-31 00:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys@0.0~git20181103.f9a6cff-1?arch=source&distro=focal"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is no longer supported. Please upgrade your system."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-46129",
        "name": "CVE-2023-46129",
        "description": "NATS.io is a high performance open source pub-sub distributed communication technology, built for the cloud, on-premise, IoT, and edge computing. The cryptographic key handling library, nkeys, recently gained support for encryption, not just for signing/authentication. This is used in nats-server 2.10 (Sep 2023) and newer for authentication callouts. In nkeys versions 0.4.0 through 0.4.5, corresponding with NATS server versions 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption handling logic mistakenly passed an array by value into an internal function, where the function mutated that buffer to populate the encryption key to use. As a result, all encryption was actually to an all-zeros key. This affects encryption only, not signing. FIXME: FILL IN IMPACT ON NATS-SERVER AUTH CALLOUT SECURITY. nkeys Go library 0.4.6, corresponding with NATS Server 2.10.4, has a patch for this issue. No known workarounds are available. For any application handling auth callouts in Go, if using the nkeys library, update the dependency, recompile and deploy that in lockstep.",
        "aliases": [
          "https://advisories.nats.io/CVE/secnote-2023-02.txt",
          "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9",
          "https://www.cve.org/CVERecord?id=CVE-2023-46129",
          "https://ubuntu.com/security/CVE-2023-46129"
        ]
      },
      "timestamp": "2023-10-31 00:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys@0.0~git20181103.f9a6cff-1.1?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.0~git20181103.f9a6cff-1.1?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is vulnerable to the CVE and needs fixing.",
      "status_notes": "Ubuntu Security Team classified this CVE as of Medium priority."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-46129",
        "name": "CVE-2023-46129",
        "description": "NATS.io is a high performance open source pub-sub distributed communication technology, built for the cloud, on-premise, IoT, and edge computing. The cryptographic key handling library, nkeys, recently gained support for encryption, not just for signing/authentication. This is used in nats-server 2.10 (Sep 2023) and newer for authentication callouts. In nkeys versions 0.4.0 through 0.4.5, corresponding with NATS server versions 2.10.0 through 2.10.3, the nkeys library's `xkeys` encryption handling logic mistakenly passed an array by value into an internal function, where the function mutated that buffer to populate the encryption key to use. As a result, all encryption was actually to an all-zeros key. This affects encryption only, not signing. FIXME: FILL IN IMPACT ON NATS-SERVER AUTH CALLOUT SECURITY. nkeys Go library 0.4.6, corresponding with NATS Server 2.10.4, has a patch for this issue. No known workarounds are available. For any application handling auth callouts in Go, if using the nkeys library, update the dependency, recompile and deploy that in lockstep.",
        "aliases": [
          "https://advisories.nats.io/CVE/secnote-2023-02.txt",
          "https://github.com/nats-io/nkeys/security/advisories/GHSA-mr45-rx8q-wcm9",
          "https://www.cve.org/CVERecord?id=CVE-2023-46129",
          "https://ubuntu.com/security/CVE-2023-46129"
        ]
      },
      "timestamp": "2023-10-31 00:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys@0.4.6-1?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.6-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.7-1ubuntu0.3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.7-1ubuntu0.3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server-dbgsym@2.10.7-1ubuntu0.3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server-dbgsym@2.10.7-1ubuntu0.3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server-dbgsym@2.10.7-1ubuntu0.3?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys@0.4.10-1?arch=source&distro=plucky"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nkeys-dev@0.4.10-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=source&distro=plucky"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-nats-io-nats-server-dev@2.10.24-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server@2.10.24-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server-dbgsym@2.10.24-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server-dbgsym@2.10.24-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/nats-server-dbgsym@2.10.24-1?arch=s390x"
        }
      ],
      "status": "not_affected",
      "justification": "vulnerable_code_not_present",
      "impact_statement": "This package (for the given release), while related to the CVE in some way, is not affected by the issue. CVE Notes / justification: "
    }
  ]
}