{
    "metadata": {
        "@context": "https://openvex.dev/ns/v0.2.0",
        "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/CVE-2021-21299",
        "author": "Canonical Ltd.",
        "timestamp": "2024-07-31T20:27:14.696953",
        "version": 1
    },
    "statements": [
        {
            "vulnerability": {
                "@id": "https://nvd.nist.gov/vuln/detail/CVE-2021-21299",
                "name": "CVE-2021-21299",
                "description": "hyper is an open-source HTTP library for Rust (crates.io). In hyper from version 0.12.0 and before versions 0.13.10 and 0.14.3 there is a vulnerability that can enable a request smuggling attack. The HTTP server code had a flaw that incorrectly understands some requests with multiple transfer-encoding headers to have a chunked payload, when it should have been rejected as illegal. This combined with an upstream HTTP proxy that understands the request payload boundary differently can result in \"request smuggling\" or \"desync attacks\". To determine if vulnerable, all these things must be true: 1) Using hyper as an HTTP server (the client is not affected), 2) Using HTTP/1.1 (HTTP/2 does not use transfer-encoding), 3) Using a vulnerable HTTP proxy upstream to hyper. If an upstream proxy correctly rejects the illegal transfer-encoding headers, the desync attack cannot succeed. If there is no proxy upstream of hyper, hyper cannot start the desync attack, as the client will repair the headers before forwarding. This is fixed in versions 0.14.3 and 0.13.10. As a workaround one can take the following options: 1) Reject requests that contain a `transfer-encoding` header, 2) Ensure any upstream proxy handles `transfer-encoding` correctly.",
                "aliases": [
                    "https://github.com/hyperium/hyper/security/advisories/GHSA-6hfq-h8hq-87mf",
                    "https://rustsec.org/advisories/RUSTSEC-2021-0020.html",
                    "https://crates.io/crates/hyper",
                    "https://github.com/hyperium/hyper/commit/8f93123efef5c1361086688fe4f34c83c89cec02",
                    "https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn",
                    "https://www.cve.org/CVERecord?id=CVE-2021-21299",
                    "https://ubuntu.com/security/CVE-2021-21299"
                ]
            },
            "timestamp": "2021-02-11 18:15:00 UTC",
            "products": [
                {
                    "@id": "pkg:deb/ubuntu/rust-hyper@0.12.35-1?arch=src?distro=ubuntu/focal"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/rust-hyper@0.14.27-1?arch=src?distro=ubuntu/noble"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.14.27-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.14.27-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.14.27-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.14.27-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.14.27-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.14.27-1?arch=s390x"
                }
            ],
            "status": "under_investigation",
            "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
        },
        {
            "vulnerability": {
                "@id": "https://nvd.nist.gov/vuln/detail/CVE-2021-21299",
                "name": "CVE-2021-21299",
                "description": "hyper is an open-source HTTP library for Rust (crates.io). In hyper from version 0.12.0 and before versions 0.13.10 and 0.14.3 there is a vulnerability that can enable a request smuggling attack. The HTTP server code had a flaw that incorrectly understands some requests with multiple transfer-encoding headers to have a chunked payload, when it should have been rejected as illegal. This combined with an upstream HTTP proxy that understands the request payload boundary differently can result in \"request smuggling\" or \"desync attacks\". To determine if vulnerable, all these things must be true: 1) Using hyper as an HTTP server (the client is not affected), 2) Using HTTP/1.1 (HTTP/2 does not use transfer-encoding), 3) Using a vulnerable HTTP proxy upstream to hyper. If an upstream proxy correctly rejects the illegal transfer-encoding headers, the desync attack cannot succeed. If there is no proxy upstream of hyper, hyper cannot start the desync attack, as the client will repair the headers before forwarding. This is fixed in versions 0.14.3 and 0.13.10. As a workaround one can take the following options: 1) Reject requests that contain a `transfer-encoding` header, 2) Ensure any upstream proxy handles `transfer-encoding` correctly.",
                "aliases": [
                    "https://github.com/hyperium/hyper/security/advisories/GHSA-6hfq-h8hq-87mf",
                    "https://rustsec.org/advisories/RUSTSEC-2021-0020.html",
                    "https://crates.io/crates/hyper",
                    "https://github.com/hyperium/hyper/commit/8f93123efef5c1361086688fe4f34c83c89cec02",
                    "https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn",
                    "https://www.cve.org/CVERecord?id=CVE-2021-21299",
                    "https://ubuntu.com/security/CVE-2021-21299"
                ]
            },
            "timestamp": "2021-02-11 18:15:00 UTC",
            "products": [
                {
                    "@id": "pkg:deb/ubuntu/rust-hyper@0.12.35-1?arch=src?distro=ubuntu/jammy"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+default-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+futures-cpupool-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+net2-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+runtime-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-executor-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-reactor-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-tcp-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-threadpool-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper+tokio-timer-dev@0.12.35-1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/librust-hyper-dev@0.12.35-1?arch=s390x"
                }
            ],
            "status": "not_affected",
            "justification": "component_not_present",
            "impact_statement": "This package (for the given release) does not exist in the archive."
        }
    ]
}