{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2024/CVE-2024-53859",
    "author": "Canonical Ltd.",
    "timestamp": "2025-07-16T05:49:55.806276",
    "version": 5
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2024-53859",
        "name": "CVE-2024-53859",
        "description": "go-gh is a Go module for interacting with the `gh` utility and the GitHub API from the command line. A security vulnerability has been identified in `go-gh` that could leak authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace. `go-gh` sources authentication tokens from different environment variables depending on the host involved: 1. `GITHUB_TOKEN`, `GH_TOKEN` for GitHub.com and ghe.com and 2. `GITHUB_ENTERPRISE_TOKEN`, `GH_ENTERPRISE_TOKEN` for GitHub Enterprise Server. Prior to version `2.11.1`, `auth.TokenForHost` could source a token from the `GITHUB_TOKEN` environment variable for a host other than GitHub.com or ghe.com when within a codespace. In version `2.11.1`, `auth.TokenForHost` will only source a token from the `GITHUB_TOKEN` environment variable for GitHub.com or ghe.com hosts. Successful exploitation could send authentication token to an unintended host. This issue has been addressed in version 2.11.1 and all users are advised to upgrade. Users are also advised to regenerate authentication tokens and to review their personal security log and any relevant audit logs for actions associated with their account or enterprise.",
        "aliases": [
          "https://www.cve.org/CVERecord?id=CVE-2024-53859",
          "https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh",
          "https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps",
          "https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log",
          "https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token",
          "https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens",
          "https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77",
          "https://ubuntu.com/security/notices/USN-7362-1",
          "https://ubuntu.com/security/CVE-2024-53859"
        ]
      },
      "timestamp": "2024-11-27 22:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2@2.6.0-1ubuntu0.24.04.1~esm1?arch=source&distro=esm-apps/noble"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-1ubuntu0.24.04.1~esm1?arch=s390x"
        }
      ],
      "status": "fixed",
      "status_notes": "This package (for the given release) was vulnerable, but an update has been uploaded and published."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2024-53859",
        "name": "CVE-2024-53859",
        "description": "go-gh is a Go module for interacting with the `gh` utility and the GitHub API from the command line. A security vulnerability has been identified in `go-gh` that could leak authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace. `go-gh` sources authentication tokens from different environment variables depending on the host involved: 1. `GITHUB_TOKEN`, `GH_TOKEN` for GitHub.com and ghe.com and 2. `GITHUB_ENTERPRISE_TOKEN`, `GH_ENTERPRISE_TOKEN` for GitHub Enterprise Server. Prior to version `2.11.1`, `auth.TokenForHost` could source a token from the `GITHUB_TOKEN` environment variable for a host other than GitHub.com or ghe.com when within a codespace. In version `2.11.1`, `auth.TokenForHost` will only source a token from the `GITHUB_TOKEN` environment variable for GitHub.com or ghe.com hosts. Successful exploitation could send authentication token to an unintended host. This issue has been addressed in version 2.11.1 and all users are advised to upgrade. Users are also advised to regenerate authentication tokens and to review their personal security log and any relevant audit logs for actions associated with their account or enterprise.",
        "aliases": [
          "https://www.cve.org/CVERecord?id=CVE-2024-53859",
          "https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh",
          "https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps",
          "https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log",
          "https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token",
          "https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens",
          "https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77",
          "https://ubuntu.com/security/notices/USN-7362-1",
          "https://ubuntu.com/security/CVE-2024-53859"
        ]
      },
      "timestamp": "2024-11-27 22:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2@2.6.0-2?arch=source&distro=plucky"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/golang-github-cli-go-gh-v2-dev@2.6.0-2?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    }
  ]
}