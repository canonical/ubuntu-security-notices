{
    "metadata": {
        "@context": "https://openvex.dev/ns/v0.2.0",
        "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/CVE-2024-38440",
        "author": "Canonical Ltd.",
        "timestamp": "2024-07-31T20:25:35.940083",
        "version": 1
    },
    "statements": [
        {
            "vulnerability": {
                "@id": "https://nvd.nist.gov/vuln/detail/CVE-2024-38440",
                "name": "CVE-2024-38440",
                "description": "Netatalk 3.2.0 has an off-by-one error, and resultant heap-based buffer overflow and segmentation violation, because of incorrectly using FPLoginExt in BN_bin2bn in etc/uams/uams_dhx_pam.c. The original issue 1097 report stated: 'The latest version of Netatalk (v3.2.0) contains a security vulnerability. This vulnerability arises due to a lack of validation for the length field after parsing user-provided data, leading to an out-of-bounds heap write of one byte (\\0). Under specific configurations, this can result in reading metadata of the next heap block, potentially causing a Denial of Service (DoS) under certain heap layouts or with ASAN enabled. ... The vulnerability is located in the FPLoginExt operation of Netatalk, in the BN_bin2bn function found in /etc/uams/uams_dhx_pam.c ... if (!(bn = BN_bin2bn((unsigned char *)ibuf, KEYSIZE, NULL))) ... threads ... [#0] Id 1, Name: \"afpd\", stopped 0x7ffff4304e58 in ?? (), reason: SIGSEGV ... [#0] 0x7ffff4304e58 mov BYTE PTR [r14+0x8], 0x0 ... mov rdx, QWORD PTR [rsp+0x18] ... afp_login_ext(obj=<optimized out>, ibuf=0x62d000010424 \"\", ibuflen=0xffffffffffff0015, rbuf=<optimized out>, rbuflen=<optimized out>) ... afp_over_dsi(obj=0x5555556154c0 <obj>).'",
                "aliases": [
                    "https://www.cve.org/CVERecord?id=CVE-2024-38440",
                    "https://github.com/Netatalk/netatalk/issues/1097",
                    "https://ubuntu.com/security/CVE-2024-38440"
                ]
            },
            "timestamp": "2024-06-16 13:15:00 UTC",
            "products": [
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.2-1ubuntu2.2+esm1?arch=src?distro=esm/trusty"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.2-1ubuntu2.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.2-1ubuntu2.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.2-1ubuntu2.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.2-1ubuntu2.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.2-1ubuntu2.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.2-1ubuntu2.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.2-1ubuntu2.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.2-1ubuntu2.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.2-1ubuntu2.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.2-1ubuntu2.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=src?distro=esm-apps/xenial"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.5-1ubuntu0.2+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.5-1ubuntu0.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.5-1ubuntu0.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.5-1ubuntu0.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.5-1ubuntu0.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.5-1ubuntu0.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.5-1ubuntu0.2+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.5-1ubuntu0.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.5-1ubuntu0.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.5-1ubuntu0.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.5-1ubuntu0.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.5-1ubuntu0.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@2.2.5-1ubuntu0.2+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=src?distro=esm-apps/bionic"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@2.2.6-1ubuntu0.18.04.2+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.6-1ubuntu0.18.04.2+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.6-1ubuntu0.18.04.2+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.6-1ubuntu0.18.04.2+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.6-1ubuntu0.18.04.2+esm1?arch=i386"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.6-1ubuntu0.18.04.2+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@2.2.6-1ubuntu0.18.04.2+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=src?distro=ubuntu/focal"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=src?distro=esm-apps/focal"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbg@3.1.12~ds-4ubuntu0.20.04.3+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=src?distro=ubuntu/jammy"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=src?distro=esm-apps/jammy"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.12~ds-9ubuntu0.22.04.3+esm1?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=src?distro=ubuntu/noble"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk@3.1.18~ds-1build4?arch=s390x"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.18~ds-1build4?arch=amd64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.18~ds-1build4?arch=arm64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.18~ds-1build4?arch=armhf"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.18~ds-1build4?arch=ppc64el"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.18~ds-1build4?arch=riscv64"
                },
                {
                    "@id": "pkg:deb/ubuntu/netatalk-dbgsym@3.1.18~ds-1build4?arch=s390x"
                }
            ],
            "status": "under_investigation",
            "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
        }
    ]
}