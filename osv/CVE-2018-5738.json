{
  "schema_version": "1.6.3",
  "id": "CVE-2018-5738",
  "details": "Change #4777 (introduced in October 2017) introduced an unforeseen issue in releases which were issued after that date, affecting which clients are permitted to make recursive queries to a BIND nameserver. The intended (and documented) behavior is that if an operator has not specified a value for the \"allow-recursion\" setting, it SHOULD default to one of the following: none, if \"recursion no;\" is set in named.conf; a value inherited from the \"allow-query-cache\" or \"allow-query\" settings IF \"recursion yes;\" (the default for that setting) AND match lists are explicitly set for \"allow-query-cache\" or \"allow-query\" (see the BIND9 Administrative Reference Manual section 6.2 for more details); or the intended default of \"allow-recursion {localhost; localnets;};\" if \"recursion yes;\" is in effect and no values are explicitly set for \"allow-query-cache\" or \"allow-query\". However, because of the regression introduced by change #4777, it is possible when \"recursion yes;\" is in effect and no match list values are provided for \"allow-query-cache\" or \"allow-query\" for the setting of \"allow-recursion\" to inherit a setting of all hosts from the \"allow-query\" setting default, improperly permitting recursion to all clients. Affects BIND 9.9.12, 9.10.7, 9.11.3, 9.12.0->9.12.1-P2, the development release 9.13.0, and also releases 9.9.12-S1, 9.10.7-S1, 9.11.3-S1, and 9.11.3-S2 from BIND 9 Supported Preview Edition.",
  "aliases": [],
  "related": [],
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    }
  ],
  "published": "2018-06-12T00:00:00Z",
  "modified": "2018-06-12T00:00:00Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:18.04:LTS",
        "name": "bind9",
        "purl": "pkg:deb/ubuntu/bind9@1:9.11.3+dfsg-1ubuntu1.1?arch=src?distro=bionic"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1:9.11.3+dfsg-1ubuntu1.1"
            }
          ]
        }
      ],
      "versions": [
        "1:9.10.3.dfsg.P4-12.6ubuntu1",
        "1:9.11.2.P1-1ubuntu2",
        "1:9.11.2.P1-1ubuntu3",
        "1:9.11.2.P1-1ubuntu4",
        "1:9.11.2.P1-1ubuntu5",
        "1:9.11.3+dfsg-1ubuntu1"
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "bind9": "1:9.11.3+dfsg-1ubuntu1.1",
            "bind9-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "bind9-doc": "1:9.11.3+dfsg-1ubuntu1.1",
            "bind9-host": "1:9.11.3+dfsg-1ubuntu1.1",
            "bind9-host-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "bind9utils": "1:9.11.3+dfsg-1ubuntu1.1",
            "bind9utils-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "dnsutils": "1:9.11.3+dfsg-1ubuntu1.1",
            "dnsutils-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libbind-dev": "1:9.11.3+dfsg-1ubuntu1.1",
            "libbind-export-dev": "1:9.11.3+dfsg-1ubuntu1.1",
            "libbind9-160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libbind9-160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libdns-export1100": "1:9.11.3+dfsg-1ubuntu1.1",
            "libdns-export1100-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libdns-export1100-udeb": "1:9.11.3+dfsg-1ubuntu1.1",
            "libdns1100": "1:9.11.3+dfsg-1ubuntu1.1",
            "libdns1100-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libirs-export160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libirs-export160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libirs-export160-udeb": "1:9.11.3+dfsg-1ubuntu1.1",
            "libirs160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libirs160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisc-export169": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisc-export169-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisc-export169-udeb": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisc169": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisc169-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccc-export160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccc-export160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccc-export160-udeb": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccc160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccc160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccfg-export160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccfg-export160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccfg-export160-udeb": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccfg160": "1:9.11.3+dfsg-1ubuntu1.1",
            "libisccfg160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1",
            "liblwres160": "1:9.11.3+dfsg-1ubuntu1.1",
            "liblwres160-dbgsym": "1:9.11.3+dfsg-1ubuntu1.1"
          }
        ],
        "availability": "No subscription required",
        "ubuntu_priority": "medium"
      }
    }
  ],
  "references": [
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2018-5738"
    },
    {
      "type": "REPORT",
      "url": "https://kb.isc.org/article/AA-01616/0/CVE-2018-5738"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/notices/USN-3683-1"
    },
    {
      "type": "REPORT",
      "url": "https://www.cve.org/CVERecord?id=CVE-2018-5738"
    }
  ]
}