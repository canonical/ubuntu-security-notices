{
  "id": "USN-5956-1",
  "summary": "libphp-phpmailer vulnerabilities",
  "details": "Dawid Golunski discovered that PHPMailer was not properly escaping user\ninput data used as arguments to functions executed by the system shell. An\nattacker could possibly use this issue to execute arbitrary code. This\nissue only affected Ubuntu 16.04 ESM. (CVE-2016-10033, CVE-2016-10045)\n\nIt was discovered that PHPMailer was not properly escaping characters\nin certain fields of the code_generator.php example code. An attacker\ncould possibly use this issue to conduct cross-site scripting (XSS)\nattacks. This issue was only fixed in Ubuntu 16.04 ESM and Ubuntu 18.04\nESM. (CVE-2017-11503)\n\nYongxiang Li discovered that PHPMailer was not properly converting\nrelative paths provided as user input when adding attachments to messages,\nwhich could lead to relative image URLs being treated as absolute local\nfile paths and added as attachments. An attacker could possibly use this\nissue to access unauthorized resources and expose sensitive information.\nThis issue only affected Ubuntu 16.04 ESM. (CVE-2017-5223)\n\nSehun Oh discovered that PHPMailer was not properly processing untrusted\nnon-local file attachments, which could lead to an object injection. An\nattacker could possibly use this issue to execute arbitrary code. This\nissue only affected Ubuntu 16.04 ESM. (CVE-2018-19296)\n\nElar Lang discovered that PHPMailer was not properly escaping file\nattachment names, which could lead to a misinterpretation of file types\nby entities processing the message. An attacker could possibly use this\nissue to bypass attachment filters. This issue was only fixed in Ubuntu\n16.04 ESM and Ubuntu 20.04 ESM. (CVE-2020-13625)\n\nIt was discovered that PHPMailer was not properly handling callables in\nits validateAddress function, which could result in untrusted code being\ncalled should the global namespace contain a function called 'php'. An\nattacker could possibly use this issue to execute arbitrary code. This\nissue was only fixed in Ubuntu 20.04 ESM and Ubuntu 22.04 ESM.\n(CVE-2021-3603)\n",
  "aliases": [],
  "related": [
    "CVE-2016-10033",
    "CVE-2016-10045",
    "CVE-2017-11503",
    "CVE-2017-5223",
    "CVE-2018-19296",
    "CVE-2020-13625",
    "CVE-2021-3603"
  ],
  "published": "2023-03-15T14:33:12.444421Z",
  "modified": "2023-03-15T14:33:12.444421Z",
  "affected": [
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:22.04:LTS",
        "name": "libphp-phpmailer"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.2.0-2ubuntu0.1~esm1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "libphp-phpmailer": "6.2.0-2ubuntu0.1~esm1"
          }
        ],
        "availability": "Available with Ubuntu Pro: https://ubuntu.com/pro"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:20.04:LTS",
        "name": "libphp-phpmailer"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.0.6-0.1ubuntu0.1~esm1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "libphp-phpmailer": "6.0.6-0.1ubuntu0.1~esm1"
          }
        ],
        "availability": "Available with Ubuntu Pro: https://ubuntu.com/pro"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:18.04:LTS",
        "name": "libphp-phpmailer"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.2.14+dfsg-2.3+deb9u2ubuntu0.1~esm1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "libphp-phpmailer": "5.2.14+dfsg-2.3+deb9u2ubuntu0.1~esm1"
          }
        ],
        "availability": "Available with Ubuntu Pro: https://ubuntu.com/pro"
      }
    },
    {
      "package": {
        "ecosystem": "Ubuntu:Pro:16.04:LTS",
        "name": "libphp-phpmailer"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.2.14+dfsg-1ubuntu0.1~esm1"
            }
          ]
        }
      ],
      "ecosystem_specific": {
        "binaries": [
          {
            "libphp-phpmailer": "5.2.14+dfsg-1ubuntu0.1~esm1"
          }
        ],
        "availability": "Available with Ubuntu Pro: https://ubuntu.com/pro"
      }
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://ubuntu.com/security/notices/USN-5956-1"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2016-10033"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2016-10045"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2017-11503"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2017-5223"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2018-19296"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2020-13625"
    },
    {
      "type": "REPORT",
      "url": "https://ubuntu.com/security/CVE-2021-3603"
    }
  ]
}