{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2021/CVE-2021-21289",
    "author": "Canonical Ltd.",
    "timestamp": "2025-06-03T18:05:24.944936",
    "version": 4
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2021-21289",
        "name": "CVE-2021-21289",
        "description": "Mechanize is an open-source ruby library that makes automated web interaction easy. In Mechanize from version 2.0.0 and before version 2.7.7 there is a command injection vulnerability. Affected versions of mechanize allow for OS commands to be injected using several classes' methods which implicitly use Ruby's Kernel.open method. Exploitation is possible only if untrusted input is used as a local filename and passed to any of these calls: Mechanize::CookieJar#load, Mechanize::CookieJar#save_as, Mechanize#download, Mechanize::Download#save, Mechanize::File#save, and Mechanize::FileResponse#read_body. This is fixed in version 2.7.7.",
        "aliases": [
          "https://github.com/sparklemotion/mechanize/security/advisories/GHSA-qrqm-fpv6-6r8g",
          "https://github.com/sparklemotion/mechanize/commit/aae0b13514a1a0caf93b1cf233733c50e679069a (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/2ac906b26f4a565a0af92df5fb9c8a36c2b75375 (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/f43a3952ab39341136656b0a8b2c8597ba1b4adc (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/b48b12f5db33c5a94a14dfcab8adf3e73cfa0388 (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/63f8779e49664d5e95fae8d42d04c8e373162b3c (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/66a6a1bfa653a5f13274a396a5e5441238656aa0",
          "https://github.com/sparklemotion/mechanize/releases/tag/v2.7.7",
          "https://rubygems.org/gems/mechanize/",
          "https://www.cve.org/CVERecord?id=CVE-2021-21289",
          "https://ubuntu.com/security/CVE-2021-21289"
        ]
      },
      "timestamp": "2021-02-02 19:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=source&distro=trusty"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=powerpc"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.2-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=source&distro=xenial"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=powerpc"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.3-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=source&distro=bionic"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.5-2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=source&distro=focal"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.6-1?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is no longer supported. Please upgrade your system."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2021-21289",
        "name": "CVE-2021-21289",
        "description": "Mechanize is an open-source ruby library that makes automated web interaction easy. In Mechanize from version 2.0.0 and before version 2.7.7 there is a command injection vulnerability. Affected versions of mechanize allow for OS commands to be injected using several classes' methods which implicitly use Ruby's Kernel.open method. Exploitation is possible only if untrusted input is used as a local filename and passed to any of these calls: Mechanize::CookieJar#load, Mechanize::CookieJar#save_as, Mechanize#download, Mechanize::Download#save, Mechanize::File#save, and Mechanize::FileResponse#read_body. This is fixed in version 2.7.7.",
        "aliases": [
          "https://github.com/sparklemotion/mechanize/security/advisories/GHSA-qrqm-fpv6-6r8g",
          "https://github.com/sparklemotion/mechanize/commit/aae0b13514a1a0caf93b1cf233733c50e679069a (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/2ac906b26f4a565a0af92df5fb9c8a36c2b75375 (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/f43a3952ab39341136656b0a8b2c8597ba1b4adc (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/b48b12f5db33c5a94a14dfcab8adf3e73cfa0388 (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/63f8779e49664d5e95fae8d42d04c8e373162b3c (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/66a6a1bfa653a5f13274a396a5e5441238656aa0",
          "https://github.com/sparklemotion/mechanize/releases/tag/v2.7.7",
          "https://rubygems.org/gems/mechanize/",
          "https://www.cve.org/CVERecord?id=CVE-2021-21289",
          "https://ubuntu.com/security/CVE-2021-21289"
        ]
      },
      "timestamp": "2021-02-02 19:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.7.7-3?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2021-21289",
        "name": "CVE-2021-21289",
        "description": "Mechanize is an open-source ruby library that makes automated web interaction easy. In Mechanize from version 2.0.0 and before version 2.7.7 there is a command injection vulnerability. Affected versions of mechanize allow for OS commands to be injected using several classes' methods which implicitly use Ruby's Kernel.open method. Exploitation is possible only if untrusted input is used as a local filename and passed to any of these calls: Mechanize::CookieJar#load, Mechanize::CookieJar#save_as, Mechanize#download, Mechanize::Download#save, Mechanize::File#save, and Mechanize::FileResponse#read_body. This is fixed in version 2.7.7.",
        "aliases": [
          "https://github.com/sparklemotion/mechanize/security/advisories/GHSA-qrqm-fpv6-6r8g",
          "https://github.com/sparklemotion/mechanize/commit/aae0b13514a1a0caf93b1cf233733c50e679069a (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/2ac906b26f4a565a0af92df5fb9c8a36c2b75375 (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/f43a3952ab39341136656b0a8b2c8597ba1b4adc (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/b48b12f5db33c5a94a14dfcab8adf3e73cfa0388 (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/63f8779e49664d5e95fae8d42d04c8e373162b3c (v2.7.7)",
          "https://github.com/sparklemotion/mechanize/commit/66a6a1bfa653a5f13274a396a5e5441238656aa0",
          "https://github.com/sparklemotion/mechanize/releases/tag/v2.7.7",
          "https://rubygems.org/gems/mechanize/",
          "https://www.cve.org/CVERecord?id=CVE-2021-21289",
          "https://ubuntu.com/security/CVE-2021-21289"
        ]
      },
      "timestamp": "2021-02-02 19:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=source&distro=oracular"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.8.5-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=source&distro=plucky"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-mechanize@2.10.1-1?arch=s390x"
        }
      ],
      "status": "not_affected",
      "justification": "vulnerable_code_not_present",
      "impact_statement": "This package (for the given release), while related to the CVE in some way, is not affected by the issue. CVE notes should contain further information, if needed."
    }
  ]
}