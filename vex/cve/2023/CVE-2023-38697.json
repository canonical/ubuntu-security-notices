{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2023/CVE-2023-38697",
    "author": "Canonical Ltd.",
    "timestamp": "2025-09-02T17:26:51.026540",
    "version": 5
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-38697",
        "name": "CVE-2023-38697",
        "description": "protocol-http1 provides a low-level implementation of the HTTP/1 protocol. RFC 9112 Section 7.1 defined the format of chunk size, chunk data and chunk extension. The value of Content-Length header should be a string of 0-9 digits, the chunk size should be a string of hex digits and should split from chunk data using CRLF, and the chunk extension shouldn't contain any invisible character. However, Falcon has following behaviors while disobey the corresponding RFCs: accepting Content-Length header values that have `+` prefix, accepting Content-Length header values that written in hexadecimal with `0x` prefix, accepting `0x` and `+` prefixed chunk size, and accepting LF in chunk extension. This behavior can lead to desync when forwarding through multiple HTTP parsers, potentially results in HTTP request smuggling and firewall bypassing. This issue is fixed in `protocol-http1` v0.15.1. There are no known workarounds.",
        "aliases": [
          "https://github.com/socketry/protocol-http1/pull/20",
          "https://www.rfc-editor.org/rfc/rfc9112#name-chunked-transfer-coding",
          "https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj",
          "https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd (v0.15.1)",
          "https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd",
          "https://www.cve.org/CVERecord?id=CVE-2023-38697",
          "https://ubuntu.com/security/CVE-2023-38697"
        ]
      },
      "timestamp": "2023-08-04 18:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.2-1?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is vulnerable to the CVE and needs fixing.",
      "status_notes": "Ubuntu Security Team classified this CVE as of Medium priority."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2023-38697",
        "name": "CVE-2023-38697",
        "description": "protocol-http1 provides a low-level implementation of the HTTP/1 protocol. RFC 9112 Section 7.1 defined the format of chunk size, chunk data and chunk extension. The value of Content-Length header should be a string of 0-9 digits, the chunk size should be a string of hex digits and should split from chunk data using CRLF, and the chunk extension shouldn't contain any invisible character. However, Falcon has following behaviors while disobey the corresponding RFCs: accepting Content-Length header values that have `+` prefix, accepting Content-Length header values that written in hexadecimal with `0x` prefix, accepting `0x` and `+` prefixed chunk size, and accepting LF in chunk extension. This behavior can lead to desync when forwarding through multiple HTTP parsers, potentially results in HTTP request smuggling and firewall bypassing. This issue is fixed in `protocol-http1` v0.15.1. There are no known workarounds.",
        "aliases": [
          "https://github.com/socketry/protocol-http1/pull/20",
          "https://www.rfc-editor.org/rfc/rfc9112#name-chunked-transfer-coding",
          "https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj",
          "https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd (v0.15.1)",
          "https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd",
          "https://www.cve.org/CVERecord?id=CVE-2023-38697",
          "https://ubuntu.com/security/CVE-2023-38697"
        ]
      },
      "timestamp": "2023-08-04 18:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=source&distro=plucky"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-protocol-http1@0.14.6-1?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    }
  ]
}