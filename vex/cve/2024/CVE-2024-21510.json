{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2024/CVE-2024-21510",
    "author": "Canonical Ltd.",
    "timestamp": "2025-07-14T05:06:07.117619",
    "version": 5
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2024-21510",
        "name": "CVE-2024-21510",
        "description": "Versions of the package sinatra from 0.0.0 are vulnerable to Reliance on Untrusted Inputs in a Security Decision via the X-Forwarded-Host (XFH) header. When making a request to a method with redirect applied, it is possible to trigger an Open Redirect Attack by inserting an arbitrary address into this header. If used for caching purposes, such as with servers like Nginx, or as a reverse proxy, without handling the X-Forwarded-Host header, attackers can potentially exploit Cache Poisoning or Routing-based SSRF.",
        "aliases": [
          "https://www.cve.org/CVERecord?id=CVE-2024-21510",
          "https://security.snyk.io/vuln/SNYK-RUBY-SINATRA-6483832",
          "https://github.com/sinatra/sinatra/pull/2053#issuecomment-2486996349",
          "https://github.com/rack/rack/commit/58eed3015d89249a3c48d144bbeabb01f69ea696",
          "https://ubuntu.com/security/CVE-2024-21510"
        ]
      },
      "timestamp": "2024-11-01 05:15:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=source&distro=focal"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@2.0.8.1-2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@2.0.8.1-2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@2.0.8.1-2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-rack-protection@3.0.5-3ubuntu1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra@3.0.5-3ubuntu1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/ruby-sinatra-contrib@3.0.5-3ubuntu1?arch=s390x"
        }
      ],
      "status": "affected",
      "action_statement": "This package (for the given release) is vulnerable to the CVE, the problem is understood, but the Ubuntu Security Team decided to not fix it. CVE Notes / justification: The patch itself appears to be a security feature that enables users to allow certain hosts in forwarded headers. The patch utilizes a dependency called ruby-rack which does not contain the implementation of RFC 7239 Forwarded header in versions of ruby-rack below 3.0. This means that the fix appears to be partial for those versions, and upstream has mentioned that they have no plans of supporting any older releases. Additionally, on jammy and below, the dependency appears to lack a feature that enables the patch, which makes the patch not apply for those releases. Since this introduces a new API to work-around the issue, doesn't fix existing uses of ruby-sinatra, and is an intrusive backport, we will not be fixing this CVE in Ubuntu stable releases."
    }
  ]
}