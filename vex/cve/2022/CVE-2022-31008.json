{
  "metadata": {
    "@context": "https://openvex.dev/ns/v0.2.0",
    "@id": "https://github.com/canonical/ubuntu-security-notices/blob/main/vex/cve/2022/CVE-2022-31008",
    "author": "Canonical Ltd.",
    "timestamp": "2025-01-13T12:15:56.184720",
    "version": 2
  },
  "statements": [
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2022-31008",
        "name": "CVE-2022-31008",
        "description": "RabbitMQ is a multi-protocol messaging and streaming broker. In affected versions the shovel and federation plugins perform URI obfuscation in their worker (link) state. The encryption key used to encrypt the URI was seeded with a predictable secret. This means that in case of certain exceptions related to Shovel and Federation plugins, reasonably easily deobfuscatable data could appear in the node log. Patched versions correctly use a cluster-wide secret for that purpose. This issue has been addressed and Patched versions: `3.10.2`, `3.9.18`, `3.8.32` are available. Users unable to upgrade should disable the Shovel and Federation plugins.",
        "aliases": [
          "https://github.com/rabbitmq/rabbitmq-server/pull/4841",
          "https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8",
          "https://www.cve.org/CVERecord?id=CVE-2022-31008",
          "https://ubuntu.com/security/CVE-2022-31008"
        ]
      },
      "timestamp": "2022-10-06 18:16:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/broker@1.1.2+ds1-2?arch=source&distro=focal"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.1.2+ds1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.1.2+ds1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.1.2+ds1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.1.2+ds1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0@1.1.2+ds1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0@1.1.2+ds1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0@1.1.2+ds1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0@1.1.2+ds1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0-dbgsym@1.1.2+ds1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0-dbgsym@1.1.2+ds1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0-dbgsym@1.1.2+ds1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker0-dbgsym@1.1.2+ds1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.1.2+ds1-2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.1.2+ds1-2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.1.2+ds1-2?arch=i386"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.1.2+ds1-2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/broker@1.4.0+ds1-1build2?arch=source&distro=noble"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build2?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build2?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build2?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build2?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build2?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build2?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build2?arch=s390x"
        }
      ],
      "status": "not_affected",
      "justification": "component_not_present",
      "impact_statement": "This package (for the given release) does not exist in the archive."
    },
    {
      "vulnerability": {
        "@id": "https://nvd.nist.gov/vuln/detail/CVE-2022-31008",
        "name": "CVE-2022-31008",
        "description": "RabbitMQ is a multi-protocol messaging and streaming broker. In affected versions the shovel and federation plugins perform URI obfuscation in their worker (link) state. The encryption key used to encrypt the URI was seeded with a predictable secret. This means that in case of certain exceptions related to Shovel and Federation plugins, reasonably easily deobfuscatable data could appear in the node log. Patched versions correctly use a cluster-wide secret for that purpose. This issue has been addressed and Patched versions: `3.10.2`, `3.9.18`, `3.8.32` are available. Users unable to upgrade should disable the Shovel and Federation plugins.",
        "aliases": [
          "https://github.com/rabbitmq/rabbitmq-server/pull/4841",
          "https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8",
          "https://www.cve.org/CVERecord?id=CVE-2022-31008",
          "https://ubuntu.com/security/CVE-2022-31008"
        ]
      },
      "timestamp": "2022-10-06 18:16:00 UTC",
      "products": [
        {
          "@id": "pkg:deb/ubuntu/broker@1.4.0+ds1-1build1?arch=source&distro=jammy"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker-dev@1.4.0+ds1-1build1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2@1.4.0+ds1-1build1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/libbroker2-dbgsym@1.4.0+ds1-1build1?arch=s390x"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build1?arch=amd64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build1?arch=arm64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build1?arch=armhf"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build1?arch=ppc64el"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build1?arch=riscv64"
        },
        {
          "@id": "pkg:deb/ubuntu/python3-broker@1.4.0+ds1-1build1?arch=s390x"
        }
      ],
      "status": "under_investigation",
      "status_notes": "The vulnerability of this package (for the given release) is not known and needs to be evaluated."
    }
  ]
}